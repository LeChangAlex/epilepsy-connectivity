
addpath('npy-matlab-master/npy-matlab');
addpath('hosa_d/hosa')  ;
savepath;
% seizure = readNPY('seizure_test.npy');
seizure = readNPY('seizure_test2.npy');

channels = ['F21', 'F22', 'F23', 'F24', 'F25', 'F26', 'F27', 'F28', 'G22', 'G23', 'G24', 'G25', 'G26', 'G27', 'G29', 'G210', 'G211', 'G212', 'G213', 'G214', 'G215', 'G216', 'G217', 'G218', 'G219', 'G220', 'G221', 'G222', 'G223', 'G224', 'G226', 'G227', 'G228', 'G229', 'G230', 'G231', 'G42', 'G43', 'G44', 'G45', 'G46', 'G47', 'G49', 'G410', 'G411', 'G412', 'G413', 'G414', 'G415', 'G416', 'G418', 'G419', 'G420', 'G421', 'G422', 'G423', 'P21', 'P22', 'P23', 'P24', 'P41', 'P42', 'ECG1', 'ECG2', 'I21', 'I22', 'I23', 'I24', 'I41', 'I42', 'I43', 'I44', 'I61', 'I62', 'I63', 'I64', 'I81', 'I82', 'I83', 'I84', 'I101', 'I102', 'I103', 'I104', 'I121', 'I122', 'I123', 'I124', 'I125', 'I126', 'T21', 'T22', 'T23', 'T24', 'T25', 'T26', 'T27', 'T28', 'T41', 'T42', 'T43', 'T44', 'T45', 'T46', 'T47', 'T61', 'T62', 'T63', 'T64', 'T65', 'T66', 'T81', 'T82', 'T83', 'T84', 'T85', 'T86', 'T3', 'C3', 'O1', 'EOG1', 'EOG2', 'EMG1', 'EMG2', 'X1', 'X2', 'X3', "X4"];

mat = zeros(115, 115);
% dbic, waxis = bispecdx(seizure(1, 1:2000), seizure(1, 1:2000), seizure(10, 1:2000), 128, 5);
nfft = 512;
axes = [-nfft/2:(nfft/2-1)]'/nfft;

bspecs = zeros(115,115, 5, 5);
for i = 1:115
%     dbic, waxis = bispecd(seizure(i, 1:2000), 128, 5);
    for j = 1:115
        ch1 = seizure(i, 1:2000);
        ch2 = seizure(j, 1:2000);
        dbic = bispecdx(ch1, ch1, ch2, nfft, 5);
        
        peak = max(max(real(dbic)));
        mat(i, j) = peak;

        
%       frequency bands hard coded atm ====================
        bspecs(i, j, :, :) = extract_features(dbic, axes);
    end
    disp(i)
end


% δ (0.5 − 4Hz) 
% θ (5 − 7Hz)
% α (8 − 15Hz)
% β (16 − 31Hz
% γ (32 − 100Hz)

% at 1k hz sampling
% 1000hz -> 1
% 100hz -> 0.1
% 32hz -> 0.032
% 
% at 250 hz sampling
% 100hz -> 0.25
% 32hz -> 0.08
% 16hz -> 0.04
% 15hz ->

% =========================
% label: I63, I64, I83, I84, maybe I103
% predict:
% 
% 0 F21
% 1 F22
% 2 F23
% 3 F24
% 4 F25
% 5 F26
% 6 F27
% 7 F28
% 8 G22
% 9 G23
% 10 G24
% 11 G25
% 12 G26
% 13 G27
% 14 G29
% 15 G210
% 16 G211
% 17 G212
% 18 G213
% 19 G214
% 20 G215
% 21 G216
% 22 G217
% 23 G218
% 24 G219
% 25 G220
% 26 G221
% 27 G222
% 28 G223
% 29 G224
% 30 G226
% 31 G227
% 32 G228
% 33 G229
% 34 G230
% 35 G231
% 36 G42
% 37 G43
% 38 G44
% 39 G45
% 40 G46
% 41 G47
% 42 G49
% 43 G410
% 44 G411
% 45 G412
% 46 G413
% 47 G414
% 48 G415
% 49 G416
% 50 G418
% 51 G419
% 52 G420
% 53 G421
% 54 G422
% 55 G423
% 56 P21
% 57 P22
% 58 P23
% 59 P24
% 60 P41
% 61 P42
% 62 I21
% 63 I22
% 64 I23
% 65 I24
% 66 I41
% 67 I42
% 68 I43
% 69 I44
% 70 I61
% 71 I62
% 72 I63
% 73 I64
% 74 I81
% 75 I82
% 76 I83
% 77 I84
% 78 I101
% 79 I102
% 80 I103
% 81 I104
% 82 I121
% 83 I122
% 84 I123
% 85 I124
% 86 I125
% 87 I126
% 88 T21
% 89 T22
% 90 T23
% 91 T24
% 92 T25
% 93 T26
% 94 T27
% 95 T28
% 96 T41
% 97 T42
% 98 T43
% 99 T44
% 100 T45
% 101 T46
% 102 T47
% 103 T61
% 104 T62
% 105 T63
% 106 T64
% 107 T65
% 108 T66
% 109 T81
% 110 T82
% 111 T83
% 112 T84
% 113 T85
% 114 T86